(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{82:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return s})),n.d(t,"metadata",(function(){return c})),n.d(t,"toc",(function(){return l})),n.d(t,"default",(function(){return d}));var a=n(3),i=n(7),o=(n(0),n(97)),r=["components"],s={id:"notifications-api",title:"Notifications API"},c={unversionedId:"notifications-api",id:"notifications-api",isDocsHomePage:!1,title:"Notifications API",description:"Purpose",source:"@site/docs/notificationss-api.md",slug:"/notifications-api",permalink:"/api-specifications/notifications-api",editUrl:"https://github.com/LBHackney-IT/api-specifications/edit/master/docs/notificationss-api.md",version:"current",sidebar:"docs",previous:{title:"Accounts API",permalink:"/api-specifications/accounts-api"},next:{title:"Patches API",permalink:"/api-specifications/patches-api"}},l=[{value:"Purpose",id:"purpose",children:[]},{value:"Context",id:"context",children:[]},{value:"Functions",id:"functions",children:[]},{value:"Vision",id:"vision",children:[]},{value:"User Needs",id:"user-needs",children:[]},{value:"Endpoints to be created",id:"endpoints-to-be-created",children:[]},{value:"Other considerations",id:"other-considerations",children:[]},{value:"Dependent Entities",id:"dependent-entities",children:[]}],p={toc:l};function d(e){var t=e.components,n=Object(i.a)(e,r);return Object(o.b)("wrapper",Object(a.a)({},p,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h2",{id:"purpose"},"Purpose"),Object(o.b)("p",null,"To identify all information to be captured with regards to the Notifications domain.  For the purpose of this specification a notification is defined as a means of notifying a user (tenant, officer, etc) that an event has occurred that is relevant to them."),Object(o.b)("h2",{id:"context"},"Context"),Object(o.b)("p",null,"To provide a tool to allow email and text message confirmations to be sent to Hackney residents, businesses and other clients."),Object(o.b)("h2",{id:"functions"},"Functions"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Email notifications - Email notifications will be sent to the email address supplied in the request (email templates, personalisation, etc required)"),Object(o.b)("li",{parentName:"ul"},"Text message notifications - Text message notifications will be sent to the number supplied in the request (text message template, personalisation, etc required)."),Object(o.b)("li",{parentName:"ul"},"Send Letters (Pending) - Letters will be sent to the address specified in the request."),Object(o.b)("li",{parentName:"ul"},"Facilitate the display of notifications on screen (eg, lists, notification count badges, Google Chrome popup)"),Object(o.b)("li",{parentName:"ul"},"Facilitate sending letters (template, personalisation, etc required)"),Object(o.b)("li",{parentName:"ul"},"Certain notifications would require follow-on actions.  Be able to identify those and provide navigation to the follow on action.  For example if a resident receives a notification (email or text) for a survey there should be a link to the survey in the notification.")),Object(o.b)("h2",{id:"vision"},"Vision"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"A single, centralized data source, holding all the notification data for possible services authorization."),Object(o.b)("li",{parentName:"ol"},"A reusable microservice API used for managing notification data."),Object(o.b)("li",{parentName:"ol"},"Avoidance of any duplication of data, a normalised view and consistency across the board.\nReducing development costs across all streams/domains.")),Object(o.b)("h2",{id:"user-needs"},"User Needs"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"As a service user I would like to receive email notifications so that I am confident that my request has been actioned."),Object(o.b)("li",{parentName:"ol"},"As a service user I would like to receive text message notifications so that I am confident that my request has been actioned."),Object(o.b)("li",{parentName:"ol"},"As a service user I would like to receive written letters so that I can be confident that my request has been actioned.\nI can take necessary action "),Object(o.b)("li",{parentName:"ol"},"As a member of the Finance team, I want to be notified of missed Service Charge payments so I can take necessary action"),Object(o.b)("li",{parentName:"ol"},"As a member of the Finance team, I want to be notified of Estimates to be approved via a Notifications screen and be able to confirm I have seen it via a pop-up so there is an audit that I have seen the notification and take necessary action."),Object(o.b)("li",{parentName:"ol"},"As a member of the Finance team, I want to be notified of Actuals to be approved and be able to confirm I have seen it via a pop-up so there is an audit that I have seen the notification and take necessary action."),Object(o.b)("li",{parentName:"ol"},"As a member of the Finance team, I want to be notified of a newly added property so I can ensure that the relevant charges are applied.\n8 .As a member of the Finance team, I want to be notified of a newly added tenure so that I can ensure that the appropriate tenure charges are applied."),Object(o.b)("li",{parentName:"ol"},"As a member of the Finance team, I want to be notified of a pending Suspense Account transfer and be able to confirm I have seen it via a pop-up so there is an audit that I have seen the notification and take necessary action."),Object(o.b)("li",{parentName:"ol"},"As a repairs manager, I want to be notified of a work order pending variation approval, so I know to approve it."),Object(o.b)("li",{parentName:"ol"},"As a repairs contractor, I want to be notified when a work order is approved, so I know to proceed with the work"),Object(o.b)("li",{parentName:"ol"},"As a DLO supervisor, I want to be notified when a work order requires follow on work, so I know to raise a new work order"),Object(o.b)("li",{parentName:"ol"},"As an RCC supervisor, I want to be notified of a high cost authorisation pending approval, so I know to approve it."),Object(o.b)("li",{parentName:"ol"},"As a resident, I want to be informed when a communal component (e.g lifts, boilers) goes out of service and its repair status"),Object(o.b)("li",{parentName:"ol"},"As a resident, I want to be reminded when a visit is due to take place to ensure I\u2019m at home"),Object(o.b)("li",{parentName:"ol"},"As a resident, I want to be notified that a satisfaction survey is available at the end of certain activities (e.g. repair, gas servicing, new tenancy created)"),Object(o.b)("li",{parentName:"ol"},"As a resident, I want to be notified when a work team cannot access my property, so I know to make it accessible*"),Object(o.b)("li",{parentName:"ol"},"As a Finance team/Repairs Team, I want to be notified when a property is involved in a legal disrepair action"),Object(o.b)("li",{parentName:"ol"},"As a Finance officer, I want to be notified that there is court action underway, "),Object(o.b)("li",{parentName:"ol"},"As a Finance officer, I want to be notified if an account is paid off so that the case can be closed"),Object(o.b)("li",{parentName:"ol"},"As an officer , I want to be notified of the death of a tenant so that due process may apply. "),Object(o.b)("li",{parentName:"ol"},"As a Tenant/Leaseholder I want to be notified/reminded of process activities that require my attention to completed so that i can take the necessary action."),Object(o.b)("li",{parentName:"ol"},"All workstreams: I want to be notified when I am due to make a visit so that I can schedule a visit, "),Object(o.b)("li",{parentName:"ol"},"As a housing officer, I want to be notified when a new cautionary contact record is entered for the property if I\u2019m due to visit that property so that I can take the necessary precautions."),Object(o.b)("li",{parentName:"ol"},"As an officer/Manager, I want to be notified when certain thresholds are passed within processes (e.g. no update to a housing management process in 2 weeks),as well as presenting this in the work tray, so that I can be kept updated without visiting the worktray."),Object(o.b)("li",{parentName:"ol"},"As a housing officer, I want to be notified that a household has a member who is subject to  cautionary contact so I can take the necessary precautions."),Object(o.b)("li",{parentName:"ol"},"As a Developer, I would like to be able to receive and save the notification information to DB,"),Object(o.b)("li",{parentName:"ol"},"As a Developer I would like to display all notification request"),Object(o.b)("li",{parentName:"ol"},"As a Developer I would like to update the record with user  actions."),Object(o.b)("li",{parentName:"ol"},"As a Developer I would like to send feedback to the relevant service that sent the notification."),Object(o.b)("li",{parentName:"ol"},"As a developer, I want to have an interface to manage sending notifications so that I can focus on implementing my code and not worry about how to handle customer notifications.")),Object(o.b)("h2",{id:"endpoints-to-be-created"},"Endpoints to be created"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"POST ",Object(o.b)("strong",{parentName:"p"},"/notifications")),Object(o.b)("p",{parentName:"li"},Object(o.b)("strong",{parentName:"p"},"Function:")," Creates a notification and sends via Gov Uk Notify"),Object(o.b)("p",{parentName:"li"},Object(o.b)("strong",{parentName:"p"},"Request Payload:")),Object(o.b)("pre",{parentName:"li"},Object(o.b)("code",{parentName:"pre"},'{\n    \u201ctargetId\u201d:\u201d7e6041e2-01b6-4c41-9ccd-5b0932616b50\u201d,\n    \u201ctargetType\u201d:\u201dFailedDirectDebits,MissedServiceChargePayments,Estimates,Actuals\u201d, \n    \u201cnotificationType\u201d:\u201dScreen,Email, Text, Letter\u201d,\n    \u201cuser\u201d:\u201dtest.user@hackney.gov.uk\u201d,\n    \u201cmessage\u201d: \u201c3 missed service charge payments have exceeded the tolerance period\u201d,\n    \u201cserviceKey\u201d : \u201csample-15f6815b-....\u201d,  // required except for screen notifications\n    \u201ctemplateId\u201d : \u201cc6a75cc9-1193-...\u201d // required except for screen notifications\n    \u201cmobileNumber\u201d:\u201d0123 456 7890\u201d, // required if notificationType is Text\n    \u201cemail\u201d:\u201dtest@example.com\u201d, // required if notificationType is Email\n    "personalisationParams": // dynamic but must match the template requirements on gov notify\n    {\n        "name": "value",\n        "name": "value",\n        \u201cfirstName\u201d : \u201cJoe\u201d,\n        \u201clastName\u201d : \u201dBloggs\u201d,\n        \u201caddressLine1\u201d : \u201d\u201d,  // at least 3 address lines are required\n        \u201caddressLine2\u201d : \u201d\u201d,\n        \u201caddressLine3\u201d : \u201d\u201d,\n        \u201caddressLine4\u201d : \u201d\u201d,\n        \u201caddressLine5\u201d : \u201d\u201d,\n        \u201caddressLine6\u201d : \u201d\u201d,\n        \u201caddressLine7\u201d : \u201d\u201d\n    },\n    \u201crequireAction\u201d: \u201ctrue\u201d,\n    \u201crequireEmailNotification\u201d: false,\n    \u201crequireSmsNotification\u201d: false,\n    \u201crequireLetter\u201d: false\n}\n'))),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"GET ",Object(o.b)("strong",{parentName:"p"},"/notifications?notificationType=","[Screen, Email, Text]","&targetId=","[targetId]")),Object(o.b)("p",{parentName:"li"},Object(o.b)("strong",{parentName:"p"},"Function:")," Gets a set of notifications for a particular channel (eg. screen) and target type"),Object(o.b)("p",{parentName:"li"},Object(o.b)("strong",{parentName:"p"},"Response Payload:")),Object(o.b)("pre",{parentName:"li"},Object(o.b)("code",{parentName:"pre"},'[\n    {\n        "id": "2adbbec5-cf23-414d-beb3-e6d07968e7b9",\n        "targetId": "Ida1029365-62b1-42e4-b71f-3793ac6ea48f",\n        "targetType": "FailedDirectDebits",\n        "notificationType": "Screen",\n        "user": null,\n        "message": "Direct Debit failed",\n        "serviceKey": null,\n        "templateId": null,\n        "mobileNumber": "09887673562",\n        "email": "test@test.com",\n        "requireAction": false,\n        "requireEmailNotification": false,\n        "requireSmsNotification": false,\n        "requireLetter": false,\n        "isReadStatus": false,\n        "sentMessageDetails": null,\n        "actionNote": null,\n        "performedActionDoneBy": null,\n        "performedActionType": null,\n        "isRemovable": true,\n        "personalisationParams": \n        {\n            "firstName": "First Name",\n            "lastName": "Last Name",\n            "city": "city"\n        },\n        "performedActionDate": null,\n        "createdDate": "2021-11-12T10:19:45.6224673Z"\n    }\n]\n'))),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"GET ",Object(o.b)("strong",{parentName:"p"},"/message-status/{service}/{notificationId}"),"\n",Object(o.b)("strong",{parentName:"p"},"Function:")," Gets the status of a message sent within the retention period (7 days)\n",Object(o.b)("strong",{parentName:"p"},"Response Payload")),Object(o.b)("pre",{parentName:"li"},Object(o.b)("code",{parentName:"pre"},'{\n    "id": "76ebfdb5-c4d6-41a4-974b-67daf74028e3",\n    "completedAt": "2021-11-12T17:27:47.917033Z",\n    "emailAddress": "edward.anoghena@nudgedigital.co.uk",\n    "body": "Message",\n    "subject": "Welcome",\n    "line1": null,\n    "line2": null,\n    "line3": null,\n    "line4": null,\n    "line5": null,\n    "line6": null,\n    "phoneNumber": null,\n    "postage": null,\n    "reference": null,\n    "sentAt": "2021-11-12T17:27:47.869406Z",\n    "status": "delivered",\n    "type": "email",\n    "createdByName": null,\n    "template": \n    {\n        "id": "9500a44b-8a7f-4fff-a3b8-45763f84874e",\n        "path": "https://api.notifications.service.gov.uk/v2/template/9500a44b-8a7f-4fff-a3b8-45763f84874e/version/1",\n        "version": 1\n    }\n}\n'))),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"PATCH ",Object(o.b)("strong",{parentName:"p"},"/notifications/{id}"),"\n",Object(o.b)("strong",{parentName:"p"},"Function:")," Updates the action details of a notification\n",Object(o.b)("strong",{parentName:"p"},"Request Payload:")),Object(o.b)("pre",{parentName:"li"},Object(o.b)("code",{parentName:"pre"},"{\n    \u201cid\u201d:\u201d7e6041e2-01b6-4c41-9ccd-5b0932616b50\u201d,\n    \u201cactionType\u201d: \u201cInitiated, Approved, Validate, Rejected, IsRead\u201d,\n    \u201cactionNote\u201d:\u201d\u201d\n}\n"))),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"DELETE ",Object(o.b)("strong",{parentName:"p"},"/notifications/{id}"),"\n",Object(o.b)("strong",{parentName:"p"},"Function:")," Deletes the specified notification"))),Object(o.b)("h2",{id:"other-considerations"},"Other considerations"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"General consideration for how we treat personal information included in processes that were not completed/orphaned."),Object(o.b)("li",{parentName:"ul"},"Some sort of service governance API to check when systems don\u2019t meet specified guidelines and use the notifications service for example to alert users."),Object(o.b)("li",{parentName:"ul"},"We should consider throttling this service to prevent spamming. "),Object(o.b)("li",{parentName:"ul"},"Include sending emails with attachments"),Object(o.b)("li",{parentName:"ul"},"Additional considerations on how documents should be managed.",Object(o.b)("ul",{parentName:"li"},Object(o.b)("li",{parentName:"ul"},"Build PDFs that will then be sent to Notify "),Object(o.b)("li",{parentName:"ul"},"Arrange for those PDFs to be stored - e.g. in the Document Store"),Object(o.b)("li",{parentName:"ul"},"Return the Document Store UID to be recorded against the appropriate record (the same as the content emails and SMSs)")))),Object(o.b)("h2",{id:"dependent-entities"},"Dependent Entities"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Tenants & Leaseholders"),Object(o.b)("li",{parentName:"ul"},"Income Services"),Object(o.b)("li",{parentName:"ul"},"Revenue & Benefits")))}d.isMDXComponent=!0},97:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u}));var a=n(0),i=n.n(a);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=i.a.createContext({}),p=function(e){var t=i.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},d=function(e){var t=p(e.components);return i.a.createElement(l.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},m=i.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,r=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),d=p(n),m=a,u=d["".concat(r,".").concat(m)]||d[m]||b[m]||o;return n?i.a.createElement(u,s(s({ref:t},l),{},{components:n})):i.a.createElement(u,s({ref:t},l))}));function u(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,r=new Array(o);r[0]=m;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:a,r[1]=s;for(var l=2;l<o;l++)r[l]=n[l];return i.a.createElement.apply(null,r)}return i.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"}}]);